install.packages("caret")
install.packages("DataExplorer")
install.packages("randomForest")
install.packages("e1071")
install.packages("dplyr")
install.packages("tidyverse")
setwd('C:/Users/bowenpallyd/Desktop')
library(caret)
library(DataExplorer)
library(randomForest)
library(tidyverse)
library(e1071)
library(dplyr)
df<-read.csv("C:/Users/bowenpallyd/Downloads/heart-disease-uci/heart.csv")
head(df)
plot_correlation(df)
plot_missing(df)
boxplot(df)
df$target<-as.factor(df$target)
idx<-createDataPartition(df$target,p=0.7,list=F)
traindf<-df[idx,]
testdf<-df[-idx,]
head(traindf)
fitControl<-trainControl(method="repeatedcv",number=10,repeats=5,search="random")
rf_fit<-train(target~.,traindf,method="rf",trControl=fitControl,verbose=F)
rf_fit
pre<-predict(rf_fit,testdf)
pre
confusionMatrix(testdf$target,pre)

